<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Guitar Strings Harmonic Visualization</title>
<script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />
<style>
  #jxgbox {
    width: 900px;
    height: 400px;
    border: 1px solid #ccc;
  }
  .description {
    max-width: 900px;
    font-family: Arial, sans-serif;
    margin-bottom: 1em;
  }
  #freqVal {
    font-weight: bold;
    font-size: 1.2em;
  }
  .bar-label {
    font-size: 14px;
    font-family: monospace;
    text-anchor: middle;
  }
  .string-name {
    font-weight: bold;
    fill: #cc3333;
    font-size: 16px;
  }
</style>
</head>
<body>

<div class="description">
  <h2>Guitar Strings & Harmonics Visualization</h2>
  <p>
    This graph shows the first 6 harmonics of a fundamental frequency \( f \), which corresponds roughly to the 6 guitar strings tuned in standard tuning: <br>
    <b>E (82 Hz), A (110 Hz), D (147 Hz), G (196 Hz), B (247 Hz), e (330 Hz)</b><br>
    Adjust the fundamental frequency with the slider below. Notice how the harmonics relate to the guitar stringsâ€™ frequencies and their relative amplitudes \( \frac{1}{n} \).
  </p>
  <p>
    Fundamental frequency \( f \): <span id="freqVal">82</span> Hz (approx. low E string)
  </p>
</div>

<div id="jxgbox"></div>

<div style="margin-top:10px;">
  <label for="freqSlider">Fundamental Frequency (Hz): </label>
  <input type="range" id="freqSlider" min="70" max="90" step="0.1" value="82" style="width:400px;">
</div>

<script>
const board = JXG.JSXGraph.initBoard('jxgbox', {
  boundingbox: [-1, 1.2, 7, -0.2],
  axis: true,
  keepaspectratio: false,
  showCopyright: false,
  showNavigation: false
});

const guitarStrings = ['E', 'A', 'D', 'G', 'B', 'e']; // standard tuning names
const maxHarmonic = 6;

let bars = [];
let freqLabels = [];
let stringLabels = [];

function drawBars(fundamentalFreq) {
  // Remove previous bars and labels
  bars.forEach(bar => board.removeObject(bar));
  freqLabels.forEach(label => board.removeObject(label));
  stringLabels.forEach(label => board.removeObject(label));
  bars = [];
  freqLabels = [];
  stringLabels = [];

  for (let n = 1; n <= maxHarmonic; n++) {
    const amp = 1 / n;

    // Draw vertical bar from (n,0) to (n, amp)
    let bar = board.create('segment', [[n, 0], [n, amp]], {
      strokeColor: '#3366cc',
      strokeWidth: 10,
      fixed: true
    });
    bars.push(bar);

    // Frequency label above bar
    let freq = (fundamentalFreq * n).toFixed(1);
    let freqLabel = board.create('text', [n, amp + 0.06, freq + ' Hz'], {
      anchorX: 'middle',
      fontSize: 14,
      fixed: true,
      cssClass: 'bar-label'
    });
    freqLabels.push(freqLabel);

    // Guitar string name above frequency label
    let stringLabel = board.create('text', [n, amp + 0.12, guitarStrings[n - 1]], {
      anchorX: 'middle',
      fontSize: 18,
      fixed: true,
      cssClass: 'string-name'
    });
    stringLabels.push(stringLabel);
  }
}

// Initial draw
let currentFundFreq = 82;
drawBars(currentFundFreq);

// Update function
function update() {
  currentFundFreq = parseFloat(document.getElementById('freqSlider').value);
  document.getElementById('freqVal').innerText = currentFundFreq.toFixed(1);
  drawBars(currentFundFreq);
  board.update();
}

document.getElementById('freqSlider').addEventListener('input', update);

</script>

</body>
</html>
