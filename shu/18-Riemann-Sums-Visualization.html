<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interactive Riemann Sums Visualization</title>
  <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 750px;
    }
    #box {
      width: 700px;
      height: 450px;
      border: 1px solid #ccc;
      margin-bottom: 15px;
    }
    .controls {
      margin-bottom: 10px;
    }
    label {
      margin-right: 10px;
      font-weight: bold;
    }
    input[type=range] {
      vertical-align: middle;
      width: 300px;
    }
    #sumValue {
      font-size: 1.2em;
      color: #0066cc;
      font-weight: bold;
      margin-left: 15px;
    }
    #explanation {
      background-color: #eef6fb;
      border-left: 4px solid #2196F3;
      padding: 12px 20px;
      margin-bottom: 20px;
      font-size: 0.95em;
      line-height: 1.5;
      color: #333;
    }
  </style>
</head>
<body>

  <h2>Interactive Riemann Sums: Approximate integral of f(x) = x²</h2>

  <div id="explanation">
    <strong>Concept Explanation:</strong> <br />
    The <em>Riemann sum</em> is a method to approximate the definite integral of a function over an interval. It works by dividing the interval into smaller subintervals, calculating the function value at specific points (here using the left endpoint), and summing up the areas of rectangles formed by these values. <br />
    As the number of rectangles increases and the width of each rectangle decreases, the Riemann sum approaches the exact value of the integral.
  </div>

  <p>Adjust the sliders below to change the interval <em>[a, b]</em> and the number of rectangles <em>n</em>, and observe how the Riemann sum approximates the area under the curve.</p>

  <div id="box"></div>

  <div class="controls">
    <label for="aRange">a (start): </label>
    <input type="range" id="aRange" min="0" max="4" step="0.1" value="0" />
    <span id="aVal">0</span>
  </div>

  <div class="controls">
    <label for="bRange">b (end): </label>
    <input type="range" id="bRange" min="0.1" max="5" step="0.1" value="2" />
    <span id="bVal">2</span>
  </div>

  <div class="controls">
    <label for="nRange">Number of rectangles (n): </label>
    <input type="range" id="nRange" min="1" max="50" step="1" value="10" />
    <span id="nVal">10</span>
  </div>

  <div>
    Riemann Sum ≈ <span id="sumValue">0</span>
  </div>

<script>
  const board = JXG.JSXGraph.initBoard('box', {
    boundingbox: [-1, 30, 6, -5],
    axis: true,
    showNavigation: false,
    zoom: { wheel: false, needshift: false, pinch: false },
    pan: { enabled: false }
  });

  // Function f(x) = x^2
  function f(x) {
    return x*x;
  }

  // Plot the function graph
  const graph = board.create('functiongraph', [f], {strokeColor: 'blue', strokeWidth: 3});

  // Store rectangles here
  let rectangles = [];

  // Current parameters
  let a = 0, b = 2, n = 10;

  // Display Riemann sum value
  const sumDisplay = document.getElementById('sumValue');

  // Remove all rectangles from board
  function clearRectangles() {
    rectangles.forEach(rect => board.removeObject(rect));
    rectangles = [];
  }

  // Draw Riemann sum rectangles (Left endpoint)
  function drawRectangles(a, b, n) {
    clearRectangles();
    if (b <= a) return;

    const deltaX = (b - a) / n;
    let sum = 0;

    for (let i = 0; i < n; i++) {
      let xLeft = a + i * deltaX;
      let height = f(xLeft);
      sum += height * deltaX;

      // Four corners of rectangle
      const pts = [
        [xLeft, 0],
        [xLeft, height],
        [xLeft + deltaX, height],
        [xLeft + deltaX, 0]
      ];

      let rect = board.create('polygon', pts, {
        fillColor: '#fbb4ae',
        fillOpacity: 0.6,
        strokeColor: '#fb8072',
        strokeWidth: 2
      });

      rectangles.push(rect);
    }
    sumDisplay.textContent = sum.toFixed(4);
  }

  // Update the plot based on sliders
  function update() {
    a = parseFloat(document.getElementById('aRange').value);
    b = parseFloat(document.getElementById('bRange').value);
    n = parseInt(document.getElementById('nRange').value);

    // Ensure b > a
    if (b <= a) {
      b = a + 0.1;
      document.getElementById('bRange').value = b.toFixed(1);
      document.getElementById('bVal').textContent = b.toFixed(1);
    }

    document.getElementById('aVal').textContent = a.toFixed(1);
    document.getElementById('bVal').textContent = b.toFixed(1);
    document.getElementById('nVal').textContent = n;

    drawRectangles(a, b, n);
    board.update();
  }

  // Bind slider events
  document.getElementById('aRange').addEventListener('input', update);
  document.getElementById('bRange').addEventListener('input', update);
  document.getElementById('nRange').addEventListener('input', update);

  // Initial draw
  update();

</script>

</body>
</html>
