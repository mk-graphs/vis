<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Kaleidoscope Symmetry Visualization</title>
<script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />
<style>
  #jxgbox {
    width: 800px;
    height: 600px;
    border: 1px solid #ccc;
  }
  body {
    font-family: Arial, sans-serif;
    margin: 1em;
  }
  .controls {
    margin-top: 1em;
  }
  label {
    margin-right: 1em;
    font-weight: bold;
  }
</style>
</head>
<body>

<h2>Kaleidoscope Symmetry Visualization</h2>
<p>Move the red point to see how the kaleidoscope pattern forms by reflecting and rotating it. Adjust the number of mirrors (symmetry order) with the slider.</p>

<div id="jxgbox"></div>

<div class="controls">
  <label for="mirrorSlider">Number of Mirrors (Symmetry Order): </label>
  <input type="range" id="mirrorSlider" min="2" max="12" value="6" step="1" />
  <span id="mirrorVal">6</span>
</div>

<script>
  const board = JXG.JSXGraph.initBoard('jxgbox', {
    boundingbox: [-10, 10, 10, -10],
    axis: true,
    showNavigation: false,
    keepaspectratio: true,
  });

  // Center point (origin)
  const center = board.create('point', [0, 0], { visible: false });

  // Movable original point
  const originalPoint = board.create('point', [4, 3], {
    name: '',
    size: 4,
    color: 'red',
    fixed: false,
  });

  // Number of mirrors slider and display
  const mirrorSlider = document.getElementById('mirrorSlider');
  const mirrorVal = document.getElementById('mirrorVal');

  // Group to hold all kaleidoscope points
  let kaleidoPoints = [];

  // Function to clear previous points/lines
  function clearKaleido() {
    kaleidoPoints.forEach(el => board.removeObject(el));
    kaleidoPoints = [];
  }

  // Function to create kaleidoscope points given symmetry order
  function createKaleidoPoints(order) {
    clearKaleido();
    const angleBetween = 360 / order;
    const px = originalPoint.X();
    const py = originalPoint.Y();

    for(let i = 0; i < order; i++) {
      // Rotate original point by i * angleBetween degrees around center
      const radians = (i * angleBetween) * Math.PI / 180;
      const xRot = px * Math.cos(radians) - py * Math.sin(radians);
      const yRot = px * Math.sin(radians) + py * Math.cos(radians);

      // Reflect points for kaleidoscope effect (simulate mirror reflections)
      // For simplicity, reflect points alternatingly on x-axis:
      let reflectedX = xRot;
      if (i % 2 === 1) {
        reflectedX = -xRot;
      }

      // Create point for this kaleidoscope copy
      const pt = board.create('point', [reflectedX, yRot], {
        name: '',
        size: 3,
        fixed: true,
        color: i % 2 === 0 ? '#0077cc' : '#cc7700',
        highlight: false,
        showInfobox: false,
        withLabel: false,
      });

      kaleidoPoints.push(pt);

      // Optional: draw lines from center to each point for clarity
      const line = board.create('line', [center, pt], {
        strokeColor: '#888',
        strokeWidth: 1,
        dash: 2,
        fixed: true,
        highlight: false,
        visible: true,
      });
      kaleidoPoints.push(line);
    }
  }

  // Initial create
  createKaleidoPoints(parseInt(mirrorSlider.value));

  // Update kaleidoscope points on slider or point move
  function updateKaleido() {
    const order = parseInt(mirrorSlider.value);
    mirrorVal.textContent = order;
    createKaleidoPoints(order);
    board.update();
  }

  mirrorSlider.addEventListener('input', updateKaleido);
  originalPoint.on('drag', updateKaleido);

</script>

</body>
</html>
