<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Binomial Distribution</title>
  <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    #box {
      width: 800px;
      height: 500px;
      border: 1px solid #aaa;
      margin-top: 20px;
    }
    label {
      display: inline-block;
      margin: 10px 10px 10px 0;
    }
    .controls {
      margin-bottom: 10px;
    }
    #explanation {
      background-color: #f0f8ff;
      padding: 10px;
      border-left: 5px solid steelblue;
    }
  </style>
</head>
<body>

<h2>Binomial Distribution</h2>

<div id="explanation">
  <strong>Concept:</strong> The binomial distribution models the number of successes in a fixed number of independent Bernoulli trials. <br>
  The formula for probability is:
  <br>
  \( P(X = k) = \binom{n}{k} p^k (1-p)^{n-k} \)
  <ul>
    <li>n = number of trials</li>
    <li>p = probability of success</li>
  </ul>
  Use the sliders below to explore how n and p affect the distribution shape.
</div>

<div class="controls">
  <label for="nSlider">n (trials):
    <input type="range" id="nSlider" min="1" max="30" value="10">
    <span id="nVal">10</span>
  </label>

  <label for="pSlider">p (success probability):
    <input type="range" id="pSlider" min="0" max="1" step="0.01" value="0.5">
    <span id="pVal">0.5</span>
  </label>
</div>

<div id="box"></div>

<script>
  // Initialize JSXGraph board
  const board = JXG.JSXGraph.initBoard('box', {
    boundingbox: [-1, 1.1, 31, -0.1],
    axis: true,
    showNavigation: false,
    zoom: {wheel: false},
    pan: {enabled: false}
  });

  let bars = [];

  // Compute binomial probability P(X = k)
  function binomial(n, k, p) {
    function factorial(x) {
      if (x === 0 || x === 1) return 1;
      let result = 1;
      for (let i = 2; i <= x; i++) result *= i;
      return result;
    }
    const comb = factorial(n) / (factorial(k) * factorial(n - k));
    return comb * Math.pow(p, k) * Math.pow(1 - p, n - k);
  }

  // Draw or redraw the distribution
  function drawDistribution(n, p) {
    // Remove old bars
    bars.forEach(bar => board.removeObject(bar));
    bars = [];

    // Create new bars
    for (let k = 0; k <= n; k++) {
      const prob = binomial(n, k, p);
      const bar = board.create('polygon', [
        [k - 0.4, 0],
        [k - 0.4, prob],
        [k + 0.4, prob],
        [k + 0.4, 0]
      ], {
        fillColor: '#4682B4',
        fillOpacity: 0.7,
        borders: {strokeColor: '#333'},
        highlight: false
      });
      bars.push(bar);
    }

    board.update();
  }

  // Handle sliders
  const nSlider = document.getElementById('nSlider');
  const pSlider = document.getElementById('pSlider');
  const nVal = document.getElementById('nVal');
  const pVal = document.getElementById('pVal');

  function update() {
    const n = parseInt(nSlider.value);
    const p = parseFloat(pSlider.value);
    nVal.textContent = n;
    pVal.textContent = p.toFixed(2);
    drawDistribution(n, p);
  }

  // Add event listeners
  nSlider.addEventListener('input', update);
  pSlider.addEventListener('input', update);

  // Initial draw
  update();
</script>

</body>
</html>
